filter {

  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  # Parse out response headers from Section F (response headers, lines 2+)
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

  # only if the server responded...WITH headers...
  if [rawSectionF] =~ /(.+?)\s(.+)\n{1}/ {

    grok {
      match => {
        "rawSectionF" => ".+?\n(?m)(?<raw_responseHeaders>.+)"
      }
      patterns_dir => "./patterns/logstash_modsecurity_patterns"
    }
  }

}