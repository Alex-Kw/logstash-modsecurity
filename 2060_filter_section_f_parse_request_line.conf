filter {
  if [type] == "mod_security" {

    #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    # Parse out server protocol/HTTP status from Section F (response related, line 1)
    #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     # response section (NO headers)
    if [rawSectionF] =~ /(.+?)\s(.+?)$/ {
      grok {
        singles => true
        match => {
          "rawSectionF" => "(?<serverProtocol>.+?)\s(?<responseStatus>.+?)$"
        }
        patterns_dir => "./patterns/logstash_modsecurity_patterns"
      }

    # response section (WITH headers)
    } else if [rawSectionF] =~ /(.+?)\s(.+?)\n{1}/ {
      grok {
        singles => true
        match => {
          "rawSectionF" => "(?<serverProtocol>.+?)\s(?<responseStatus>.+?)\n{1}"
        }
        patterns_dir => "./patterns/logstash_modsecurity_patterns"
      }
    }
  }
}