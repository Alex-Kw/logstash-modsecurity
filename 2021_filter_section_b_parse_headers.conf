filter {
  if [type] == "mod_security" {

    #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    # Parse out fields from Section B (request headers, line 2+)
    #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

    if [rawSectionB] =~ /.+?\n(?m).+/ {

      grok {
        match => {
          "rawSectionB" => ".+?\n(?m)(?<raw_requestHeaders>.+)"
        }
        patterns_dir => "./patterns/logstash_modsecurity_patterns"
      }
    }
  }
}